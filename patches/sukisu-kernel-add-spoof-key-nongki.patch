From 79bde2942a3b2afa2a51489d5c0043d01256c66e Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?YC=E9=85=B1luyancib?= <luyancib@qq.com>
Date: Sat, 5 Jul 2025 22:26:30 +0800
Subject: [PATCH] kernel:add spoof key

---
 kernel/apk_sign.c     | 3 ++-
 kernel/manager_sign.h | 4 ++++
 2 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/kernel/apk_sign.c b/kernel/apk_sign.c
index 5ee4329e..1a4830ab 100644
--- a/kernel/apk_sign.c
+++ b/kernel/apk_sign.c
@@ -304,6 +304,7 @@ static struct apk_sign_key {
 } apk_sign_keys[] = {
 	{EXPECTED_SIZE, EXPECTED_HASH},
 	{EXPECTED_SIZE_SHIRKNEKO, EXPECTED_HASH_SHIRKNEKO}, // SukiSU
+	{EXPECTED_SIZE_SPOOF, EXPECTED_HASH_SPOOF}, // Spoofed Package
 	{EXPECTED_SIZE_OTHER, EXPECTED_HASH_OTHER}, // Dynamic Sign
 };
 
@@ -612,4 +613,4 @@ module_param_cb(ksu_debug_manager_uid, &expected_size_ops,
 bool is_manager_apk(char *path)
 {
 	return check_v2_signature(path);
-}
\ No newline at end of file
+}
diff --git a/kernel/manager_sign.h b/kernel/manager_sign.h
index 4377ba8e..e4dbe524 100644
--- a/kernel/manager_sign.h
+++ b/kernel/manager_sign.h
@@ -9,4 +9,8 @@
 #define EXPECTED_SIZE_OTHER   0x300
 #define EXPECTED_HASH_OTHER   "0000000000000000000000000000000000000000000000000000000000000000"
 
+// spoofed package
+#define EXPECTED_SIZE_SPOOF   0x38c
+#define EXPECTED_HASH_SPOOF   "1e9fa119b426ecd1361d7d4e9dc25d0c5c1bc4998acaaffb2f4b1520b775ad79"
+
 #endif /* MANAGER_SIGN_H */
-- 
2.39.5

